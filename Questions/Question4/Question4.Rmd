---
title: "Paged HTML Document"
author: "NF Katzke"
date: "November 2021"
# date: "`r Sys.Date()`"
bibliography: Tex/ref.bib       # Do not edit: Keep this naming convention and location.
output:
  pagedown::html_paged:
    # template: wp_paged.html
    # css: ['wp.css', 'wp-fonts.css', 'wp-page.css']
    css: ["Template/default-fonts-Texevier.css", "Template/default-page-Texevier.css", "Template/default-Texevier.css"]
    csl: Template/harvard-stellenbosch-university.csl # referencing format used.
    template: ["Template/paged-Texevier.html"]

    toc: true
    # change to true for a self-contained document, but it'll be a litte slower for Pandoc to render
    self_contained: TRUE
abstract: |
    This is an abstract. Much can be written here. Uncomment this line to go without an abstract.
    Abstracts have no spaces, but can have bullets.

    Bullets can be created as follows

    + You can add bullets, but do not add colons please.

    + Line breaks are also not permitted.

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
pacman::p_load(modelsummary, gt, knitr, kableExtra, tidyverse)
```

\newpage

# Introduction {-}



> I suggest renaming the top line after \@article, as done in the template ref.bib file, to something more intuitive for you to remember. Do not change the rest of the code. Also, be mindful of the fact that bib references from google scholar may at times be incorrect. Reference Latex forums for correct bibtex notation.

<!-- The following is a code chunk. It must have its own unique name (after the r), or no name. After the comma follows commands for R which are self-explanatory. By default, the code and messages will not be printed in your pdf, just the output: -->

```{r }

  # This is just a random plot to show you a plot. This is done if the getwd() does not point to your Template's directory.
  # Set WD below to your project's working directory.

Port_Holds <- read_rds("/Users/x/Downloads/28736907_Fin_Metrics/Questions/Question4/data/Fund_Holds.rds")
Port_Rets <- read_rds("/Users/x/Downloads/28736907_Fin_Metrics/Questions/Question4/data/Fund_Rets.rds")
BM_Holds <- read_rds("/Users/x/Downloads/28736907_Fin_Metrics/Questions/Question4/data/BM_Holds.rds")
BM_Rets <- read_rds("/Users/x/Downloads/28736907_Fin_Metrics/Questions/Question4/data/BM_Rets.rds")
Capped_SWIX <- read_rds("/Users/x/Downloads/28736907_Fin_Metrics/Questions/Question4/data/Capped_SWIX.rds")
ALSI <- read_rds("/Users/x/Downloads/28736907_Fin_Metrics/Questions/Question4/data/ALSI.rds")

```

Relative Risk
Tracking Error

```{r}
library(tidyverse)
library(fmxdat)
library(lubridate)
library(xts)
library(tbl2xts)

Swix <- BM_Rets %>% filter(date >= ymd(20191031))
Endate <- ymd(20241031)

Ra <- Swix %>%
    filter(date <= Endate) %>%
    filter(date >= fmxdat::safe_month_min(last(date), N = 36)) %>%
    tbl2xts::tbl_xts(cols_to_xts = BM)

Rs <- Port_Rets %>%
    filter(date <= Endate) %>%
    filter(date >= fmxdat::safe_month_min(last(date), N = 36)) %>%
    tbl2xts::tbl_xts(cols_to_xts = Returns)

pacman::p_load(tbl2xts, PerformanceAnalytics)

xts_port <- tbl_xts(Port_Rets)
xts_bench <- tbl_xts(BM_Rets)





TE <- fmxdat::Safe_TE(Ra, Rs, scale = 12)
```

```{r}
chart.RollingPerformance(merged, 12, legend.loc = 1)
```


```{r}

```


```{r}
chart.Drawdown(xts_port,main = "Drawdowns: Sanlam", 
               col = "steelblue")
```

```{r}
chart.CumReturns(xts_port,main = "Drawdowns: Sanlam", 
               col = "steelblue")
```

```{r}
chart.RollingRegression(Ra = xts_port, Rb = xts_bench, width = 12,
    attribute = c("Beta"))
```

```{r}
sfm <- table.SFM(Ra = xts_port, Rb = xts_bench, 12)
```

```{r}

merged <- merge.xts(xts_port, xts_bench)
chart.CumReturns(merged, legend.loc = 1)
```

Relative performane
```{r}
chart.RelativePerformance(xts_port, xts_bench)
```
Information ratio
```{r}
library(rportfolio)

IR <- ratio.information(xts_port, xts_bench)
```

Sector weights

```{r}

plot_sector_weights(Port_Holds, BM_Holds)
```

Stock concentration

```{r}

plot_stock_concentration(merged_data, ALSI)

```



```{r}
# Load the knitr library for formatting
library(knitr)

sfm <- rbind(
  sfm,
  data.frame(Metric = "Information Ratio (dynamic)", Value = IR, stringsAsFactors = FALSE),
  data.frame(Metric = "Tracking Error (dynamic)", Value = TE, stringsAsFactors = FALSE)
)
# Display the sfm data frame as a formatted table
kable(sfm, caption = "Summary of Statistics from sfm")

```


# References {-}

<div id="refs"></div>


# Appendix {-}

## Appendix A {-}

Some appendix information here

## Appendix B {-}



